$schema: "http://json-schema.org/draft-04/schema#"

id: "case"
title: Case
type: object
namespace: https://dcp.bionimbus.org/
category: administrative
program: '*'
project: '*'
description: >
  The collection of all data related to a specific subject in the
  context of a specific experiment. 
additionalProperties: false
submittable: true
validators: null

systemProperties:
  - id
  - project_id
  - created_datetime
  - updated_datetime
  - state

links:
  - name: studies 
    backref: cases
    label: member_of
    target_type: study
    multiplicity: many_to_many
    required: true

required:
  - type
  - submitter_id
  - studies 

uniqueKeys:
  - [id]
  - [project_id, submitter_id]

# Case properties
properties:
  $ref: "_definitions.yaml#/ubiquitous_properties"

  amputation_type:
    description: >
      If amputated, the amputation type for leg, above the knee or below the knee.   
    type: string

  site:
    description: >
      Site where the case was recruted.
    type: string

  cohort_id:
    description: >
      The study subgroup that the participant belongs to. This indicates whether the participant was a postmortem donor, 
      an organ donor, or a surgical donor.   
    enum: 
      - Postmortem
      - Organ Donor (OPO)
      - Surgical Donor

  eligibility:
    description: >
      A verification field of whether the Donor has met the overall eligibility criteria for GTEx collection based on answers 
      to eligibility questions. All Eligibility conditions require confirmation from the donor procurement team (staff team where 
      tissue collection and data abstraction takes place) and must be met in order for donor to eligible.  
    type: boolean

  index_date:
    description: >
      "Indicates whether the time point reference begins at the donor's actual death, presumed death, 
      or when the cross clamp was applied in the case of surgical donors."
    enum:
      - Actual Death
      - Presumed Death
      - Cross Clamp
      - Study Enrollment
      - Diagnosis
      - First Patient Visit

  transplanted_organ:
    description: >
      If the Donor was an Organ Donor, which Organs were donated.
    type: string

  consent_codes:
    description: >
        Data Use Restrictions that are used to indicate  permissions/restrictions for datasets and/or materials, and relates to the purposes for which datasets and/or material might be removed, stored or used. \n
        Based on the Data Use Ontology : see http://www.obofoundry.org/ontology/duo.html \n
        GRU - For general research use for any research purpose. Example of usage: This includes but is not limited to: health/medical/biomedical purposes, fundamental biology research, the study of population origins or ancestry, statistical methods and algorithms development, and social-sciences research. \n
        HMB - Use of the data is limited to health/medical/biomedical purposes; does not include the study of population origins or ancestry. \n
        DS-X - Use of the data must be related to [disease]. \n
        NPU - Use of the data is limited to not-for-profit organizations and not-for-profit use, non-commercial use. \n
        IRB - Requestor must provide documentation of local IRB/REC approval.
    type: array
    items:
      type: string

  studies:
    $ref: "_definitions.yaml#/to_many"
